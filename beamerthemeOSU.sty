%This file contains custom setup stuff to alter theme from base metropolis
%Initial work Austin Warren 10/25/2022
%Initial theme work Jeremy Lilly 10/5/2019
%Current Editor Robert Powers 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%This block is used for presenter's notes, but it needs an external program or something to work
% https://github.com/Cimbali/pympress/
% \usepackage{pgfpages}
% \setbeamertemplate{note page}[plain]
% \setbeameroption{show notes on second screen=right}

%%%%%%%%% Theme definitions %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{iftex}

\ifLuaTeX
    \RequirePackage{fontspec}
\else
    \ifXeTeX
        \RequirePackage{fontspec}
    \else
        \RequirePackage[utf8]{inputenc}
        \RequirePackage[T1]{fontenc}
    \fi
\fi


\RequirePackage{parskip}
\RequirePackage{tikz}
\RequirePackage{bookmark}
\RequirePackage{graphicx}

\usetikzlibrary{positioning}


\newcommand{\department}[1]{\def\insertdepartment{#1}}
\newcommand{\supervisor}[1]{\def\insertsupervisor{#1}}
\newcommand{\cosupervisor}[1]{\def\insertcosupervisor{#1}}

%%%%%%%%% Packages Needed %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Packages used with initial Metropolis theme
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage[scale=2]{ccicons}
\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}
\usepackage{xspace}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

%%%%% Added User Packages
\usepackage{svg}
\usepackage{xcolor}
\usepackage{fontspec}

%%%%%%%%% Color definitions %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% OSU Primary Colors
\definecolor{osu_black}{HTML}{000000}       %Paddletail Black
\definecolor{osu_white}{HTML}{FFFFFF}       %Bucktooth White
\definecolor{osu_orange}{HTML}{D73F09}      %Beaver Orange

%%%%% OSU Secondary Colors
\definecolor{osu_pinestand}{HTML}{4A773C}   %OSU (green)
\definecolor{osu_hightide}{HTML}{00859B}    %OSU (teal)
\definecolor{osu_luminance}{HTML}{FFB500}   %OSU (yellow)
\definecolor{osu_stratosphere}{HTML}{006A8E} %OSU (blue)
\definecolor{osu_reindeermoss}{HTML}{C4D6A4} %OSU (light-green)
\definecolor{osu_seaform}{HTML}{B8DDE1}     %OSU (light-blue)
\definecolor{osu_candela}{HTML}{FDD26E}     %OSU (light-yellow)
\definecolor{osu_moondust}{HTML}{C6DAE7}    %OSU (light-purple)
\definecolor{osu_hopbine}{HTML}{AA9D2E}     %OSU (orange-green)
\definecolor{osu_roguewave}{HTML}{0D5257}   %OSU (dark-teal)
\definecolor{osu_solarflare}{HTML}{D3832B} %OSU (orange)
\definecolor{osu_starcanvas}{HTML}{003B5C}  %OSU (dark purple)
\definecolor{osu_till}{HTML}{B7A99A}        %OSU (light-red-brown)
\definecolor{osu_coastline}{HTML}{A7ACA2}   %OSU (light-gray)
\definecolor{osu_highdesert}{HTML}{7A6855}  %OSU (brown)
\definecolor{osu_crater}{HTML}{8E9089}      %OSU (gray)

%%%%% User Defined Colors
\definecolor{osu_midorange}{HTML}{D35400}   %mid-orange
\definecolor{osu_lightorange}{HTML}{E59866} %light-orange
\definecolor{osu_red}{HTML}{C0392B}         %Red
\definecolor{osu_lightred}{HTML}{D98880}    %light-red


%%%%%%%%% Color palette Definitions %%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Title Slide Color
\setbeamercolor{title separator}{fg=osu_orange}

% Main palette
\setbeamercolor*{palette primary}{bg=osu_orange, fg=white}
\setbeamercolor*{palette secondary}{bg=osu_black, fg=white}
\setbeamercolor*{palette ternary}{bg=osu_orange, fg=white}
\setbeamercolor{normal text}{fg=osu_black}

% block environment
\setbeamercolor{block title}{bg=osu_orange, fg=black}
\setbeamercolor{block body}{bg=osu_lightorange, fg=black}

% alertblock environment
\setbeamercolor{block title alerted}{bg=osu_red, fg=black}
\setbeamercolor{block body alerted}{bg=osu_lightred, fg=black}

% example environment
\setbeamercolor{block title example}{bg=osu_solarflare, fg=black}
\setbeamercolor{block body example}{bg=osu_candela, fg=black}

% TOC sections
\setbeamercolor{section in toc}{fg=osu_orange}

%%%%% General Slides 
\setbeamercolor{frametitle}{bg=osu_orange} % change frame title colors
\setbeamercolor{progress bar}{fg=osu_black,bg=osu_crater} % change progress bar colors

%%%%% Transition breaks
\setbeamercolor{progress bar in section page}{fg=osu_orange,bg=osu_coastline}

% itemize, enumerate, etc
\setbeamercolor{structure}{fg=osu_orange}

% bibliography text
\setbeamercolor{bibliography entry author}{fg=osu_black}
\setbeamercolor{bibliography entry journal}{fg=osu_black}
\setbeamercolor{bibliography entry location}{fg=osu_black}
\setbeamercolor{bibliography entry volume}{fg=osu_black}
\setbeamercolor{bibliography entry number}{fg=osu_black}
\setbeamercolor{bibliography entry pages}{fg=osu_black}
\setbeamercolor{bibliography entry year}{fg=osu_black}
\setbeamercolor{bibliography entry publisher}{fg=osu_black}
\setbeamercolor{bibliography entry address}{fg=osu_black}
\setbeamercolor{bibliography entry institution}{fg=osu_black}
\setbeamercolor{bibliography entry note}{fg=osu_black}
\setbeamercolor{bibliography entry school}{fg=osu_black}
\setbeamercolor{bibliography entry volume}{fg=osu_black}
\setbeamercolor{bibliography entry booktitle}{fg=osu_black}
\setbeamercolor{bibliography entry edition}{fg=osu_black}
\setbeamercolor{bibliography entry type}{fg=osu_black}
\setbeamercolor{bibliography entry annote}{fg=osu_black}

                                                           
%%%%%%%%% Font Definitions %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usefonttheme{professionalfonts}
\ifLuaTeX
    \setmainfont{Georgia}
    \setsansfont{Verdana}
\else
    \ifXeTeX
        \setmainfont{Georgia}
        \setsansfont{Verdana}
    \else
        % nothing
    \fi
\fi

% Title slide
\setbeamerfont{title}{family=\sffamily, series=\bfseries, size=\LARGE}
\setbeamerfont{subtitle}{family=\sffamily, series=\mdseries, size=\large}
\setbeamerfont{author}{family=\sffamily, size=\normalsize}
\setbeamerfont{supervisor}{family=\sffamily, size=\small}
\setbeamerfont{cosupervisor}{family=\sffamily, size=\small}
\setbeamerfont{date}{family=\sffamily, size=\small}
\setbeamerfont{department}{family=\sffamily, size=\scriptsize}
\setbeamerfont{institute}{family=\sffamily, size=\scriptsize}

% Frametitles
\setbeamerfont{frametitle}{family=\rmfamily, series=\bfseries}
\setbeamerfont{framesubtitle}{family=\rmfamily, series=\mdseries, size=\large}

% TOC
\setbeamerfont{section in toc}{family=\rmfamily, series=\bfseries, size=\large}

                                                     
%%%%%%%%% Inner Theme Definitions %%%%%%%%%%%%%%%%%%%%%%%%%%
% Title page
\setbeamertemplate{title page}{
    \begin{minipage}[c][\paperheight]{\textwidth}
        \ifx\inserttitlegraphic\@empty\else\usebeamertemplate*{title graphic}\fi
        \vfill%
        {
        \centering
        \ifx\inserttitle\@empty\else\usebeamertemplate*{title}\fi
        \ifx\insertsubtitle\@empty\else\usebeamertemplate*{subtitle}\fi
        }
        \usebeamertemplate*{title separator}
        
        \begin{minipage}[t]{.45\textwidth}
            \vspace*{-1.5em}
            \ifx\beamer@shortauthor\@empty\else\usebeamertemplate*{author}\fi
            \ifx\insertdate\@empty\else\usebeamertemplate*{date}\fi
        \end{minipage}
        \begin{minipage}[t]{.55\textwidth}
            \vspace*{0.5em}
            {\hspace{2.2em} \usebeamerfont{supervisor}{Supervisor: \textit\insertsupervisor}\\}
            \vspace*{0.2em}
            {\hspace{2.2em} \usebeamerfont{cosupervisor}{Co-Supervisor: \textit\insertcosupervisor}}
        \end{minipage}%

        \begin{minipage}[t]{\textwidth}
            %\centering
            \vspace*{0.2em}
            \ifx\insertinstitute\@empty\else\usebeamertemplate*{institute} 
            \vspace*{0.2em}
            \usebeamerfont{department}\insertdepartment\fi
        \end{minipage}
        \vfill
        \vspace*{1mm}
    \end{minipage}
}
%\setbeamertemplate{title}{
%%  \raggedright%  % <-- Comment here
%  \linespread{1.0}%
%  \inserttitle%
%  \par%
%  \vspace*{0.5em}
%}
%\setbeamertemplate{subtitle}{
%%  \raggedright%  % <-- Comment here
%  \insertsubtitle%
%  \par%
%  \vspace*{0.5em}
%}


\titlegraphic{%
  \begin{picture}(0,0)
    \put(410,-210){\makebox(0,0)[rt]{\includegraphics[scale=0.3]{images/OSU/EPS/OSU_horizontal_2C_O_over_B.eps}}}
  \end{picture}}

% Table of contents
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

% Itemize environments
\setbeamertemplate{itemize items}[circle]


%%%%%%%%%% Outer Theme Definitions %%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% Comment out which frame title you don't want to use %%%%%%%%%%
%%%%% Frametitle #1
 %\defbeamertemplate*{frametitle}{osu_frametitle}{
 %  \setbeamertemplate{footline}{}
 %  \begin{beamercolorbox}[wd=\paperwidth, ht=1.2cm]{frametitle}
 %     \begin{tikzpicture}
 %        \useasboundingbox[fill=white](0, 0) rectangle(\the\paperwidth, 1.2);
 %        \node[inner sep=0pt] (logo) at (0.8, 0.4) %{\includegraphics[scale=0.125]{images/EPS/OSU_vertical_2C_O_over_B.eps}};
 %         \draw[line width=0.3mm, osu_orange] (1.65, 0.02) -- (\the\paperwidth, 0.02);
 %        \ifx\insertframesubtitle\@empty%
 %           {\node[anchor=west, black] at (1.6, 0.625) {\insertframetitle};}
 %        \else%
 %           {\node[anchor=west, black] at (1.6, 0.85) {\insertframetitle};
 %           \node[anchor=west, black] at (1.6, 0.35) {\usebeamerfont{framesubtitle}\insertframesubtitle};}
 %        \fi
 %     \end{tikzpicture}
 %  \end{beamercolorbox}}
 
%%%%% Frametitle #2
\makeatletter
\setbeamertemplate{frametitle}{%
  \nointerlineskip%
  \begin{beamercolorbox}[%
      wd=\paperwidth,%
      sep=0pt,%
      leftskip=\metropolis@frametitle@padding,%
      rightskip=\metropolis@frametitle@padding,%
    ]{frametitle}%
  \metropolis@frametitlestrut@start%
  \insertframetitle%
  \nolinebreak%
  \metropolis@frametitlestrut@end%
  \hfill
  \raisebox{-1.15ex}{\includegraphics[scale=0.16]{images/OSU/EPS/OSU_horizontal_2C_W_over_B.eps}}
  \end{beamercolorbox}%
  \usebeamertemplate*{progress bar in head/foot}
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%% Footline
% footline
\defbeamertemplate{footline}{osu_footline}{
   \ifnum\insertpagenumber=1
      \hbox{%
      \begin{beamercolorbox}[wd=\paperwidth, ht=0.25cm, dp=1ex]{}
         % nothing
      \end{beamercolorbox}}
   \else%
      \hbox{%
      \begin{beamercolorbox}[wd=0.2\paperwidth, ht=0.25cm, dp=1.2ex]{palette secondary}
         \tiny\; \insertdate
      \end{beamercolorbox}%
      \begin{beamercolorbox}[wd=0.6\paperwidth, ht=0.25cm, dp=1.2ex]{palette ternary}
         \centering\tiny\insertshorttitle
      \end{beamercolorbox}%
      \begin{beamercolorbox}[wd=0.2\paperwidth, ht=0.25cm, dp=1.2ex]{palette secondary}
         \tiny\hfill \insertframenumber/\inserttotalframenumber \;
      \end{beamercolorbox}}
  \fi
}
\setbeamertemplate{footline}[osu_footline]  % comment this line to remove the footer with the date and frame counter
\setbeamertemplate{standout}[]

% Remove navigation symbols
\setbeamertemplate{navigation symbols}{}


% fixes page number on standout slide
\setbeamertemplate{frame numbering}{
	\ifbool{metropolis@standout}{}{
		\insertframenumber
	}
}